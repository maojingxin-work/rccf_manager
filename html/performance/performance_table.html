<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>业绩提成信息表</title>
  <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">
  <link rel="stylesheet" type="text/css" href="../../css/amazeui.min.css"/>
</head>
<body>
<div class="am-container am-margin-lg">
  <table class="am-table am-table-bordered am-text-center">
    <thead>
    <tr>
      <th>部门</th>
      <th>总监</th>
      <th>总监业绩</th>
      <th>总监佣金</th>
      <th>副总监</th>
      <th>副总监业绩</th>
      <th>副总监佣金</th>
      <th>销售经理</th>
      <th>销售经理业绩</th>
      <th>销售经理佣金</th>
    </tr>
    </thead>
    <tbody>
    <tr>
      <td class="am-text-middle" rowspan="19">金融一部</td>
      <td class="am-text-middle" rowspan="19">陈佳丽</td>
      <td class="am-text-middle" rowspan="19">1883万</td>
      <td class="am-text-middle" rowspan="19">11233214</td>
      <td class="am-text-middle" rowspan="7">刘采访</td>
      <td class="am-text-middle" rowspan="7">213124</td>
      <td class="am-text-middle" rowspan="7">213124</td>
      <td class="am-text-middle">张三</td>
      <td class="am-text-middle">123412421</td>
      <td class="am-text-middle">312314142</td>
    </tr>
    <tr>
      <td class="am-text-middle">张三</td>
      <td class="am-text-middle">123412421</td>
      <td class="am-text-middle">312314142</td>
    </tr>
    <tr>
      <td class="am-text-middle">张三</td>
      <td class="am-text-middle">123412421</td>
      <td class="am-text-middle">312314142</td>
    </tr>
    <tr>
      <td class="am-text-middle">张三</td>
      <td class="am-text-middle">123412421</td>
      <td class="am-text-middle">312314142</td>
    </tr>
    <tr>
      <td class="am-text-middle">张三</td>
      <td class="am-text-middle">123412421</td>
      <td class="am-text-middle">312314142</td>
    </tr>
    <tr>
      <td class="am-text-middle">张三</td>
      <td class="am-text-middle">123412421</td>
      <td class="am-text-middle">312314142</td>
    </tr>
    <tr>
      <td class="am-text-middle">张三</td>
      <td class="am-text-middle">123412421</td>
      <td class="am-text-middle">312314142</td>
    </tr>
    <tr>
      <td class="am-text-middle" rowspan="7">刘采访</td>
      <td class="am-text-middle" rowspan="7">213124</td>
      <td class="am-text-middle" rowspan="7">213124</td>
      <td class="am-text-middle">张三</td>
      <td class="am-text-middle">123412421</td>
      <td class="am-text-middle">312314142</td>
    </tr>
    <tr>
      <td class="am-text-middle">张三</td>
      <td class="am-text-middle">123412421</td>
      <td class="am-text-middle">312314142</td>
    </tr>
    <tr>
      <td class="am-text-middle">张三</td>
      <td class="am-text-middle">123412421</td>
      <td class="am-text-middle">312314142</td>
    </tr>
    <tr>
      <td class="am-text-middle">张三</td>
      <td class="am-text-middle">123412421</td>
      <td class="am-text-middle">312314142</td>
    </tr>
    <tr>
      <td class="am-text-middle">张三</td>
      <td class="am-text-middle">123412421</td>
      <td class="am-text-middle">312314142</td>
    </tr>
    <tr>
      <td class="am-text-middle">张三</td>
      <td class="am-text-middle">123412421</td>
      <td class="am-text-middle">312314142</td>
    </tr>
    <tr>
      <td class="am-text-middle">张三</td>
      <td class="am-text-middle">123412421</td>
      <td class="am-text-middle">312314142</td>
    </tr>
    <tr>
      <td class="am-text-middle" rowspan="7">刘采访</td>
      <td class="am-text-middle" rowspan="7">213124</td>
      <td class="am-text-middle" rowspan="7">213124</td>
      <td class="am-text-middle">张三</td>
      <td class="am-text-middle">123412421</td>
      <td class="am-text-middle">312314142</td>
    </tr>
    <tr>
      <td class="am-text-middle">张三</td>
      <td class="am-text-middle">123412421</td>
      <td class="am-text-middle">312314142</td>
    </tr>
    <tr>
      <td class="am-text-middle">张三</td>
      <td class="am-text-middle">123412421</td>
      <td class="am-text-middle">312314142</td>
    </tr>
    <tr>
      <td class="am-text-middle">张三</td>
      <td class="am-text-middle">123412421</td>
      <td class="am-text-middle">312314142</td>
    </tr>
    <tr>
      <td class="am-text-middle">张三</td>
      <td class="am-text-middle">123412421</td>
      <td class="am-text-middle">312314142</td>
    </tr>
    </tbody>
  </table>
  <a>导出表格</a>
</div>

<script>
  // 使用outerHTML属性获取整个table元素的HTML代码（包括<table>标签），然后包装成一个完整的HTML文档，设置charset为urf-8以防止中文乱码
  var html = "<html><head><meta charset='utf-8' /></head><body>" + document.getElementsByTagName("table")[0].outerHTML + "</body></html>";
  // 实例化一个Blob对象，其构造函数的第一个参数是包含文件内容的数组，第二个参数是包含文件类型属性的对象
  var blob = new Blob([html], {type: "application/vnd.ms-excel"});
  var a = document.getElementsByTagName("a")[0];
  // 利用URL.createObjectURL()方法为a元素生成blob URL
  a.href = URL.createObjectURL(blob);
  // 设置文件名，目前只有Chrome和FireFox支持此属性
  a.download = "学生成绩表.xls";
</script>
</body>
</html>